# msa-capstone-project
## ğŸ•™ Schedule

- ì¼ìë³„ ì§„í–‰

  |   ì¼ì    | ì§„í–‰           | ë‚´ìš©                                |
  | :-------: | :------------- | :---------------------------------- |
  | 09/21 AM  | OJT            | ê³¼ì •ì„¤ëª…<br>ê³¼ì œìˆ˜í–‰í™˜ê²½ì„¤ëª…        |
  | 09/21 PM  | Brain Storming | msaez.io                            |
  | 09/22 ALL | Team Project   | íŒ€ë³„ê³¼ì œ ìˆ˜í–‰                       |
  | 09/23 AM  | Team Project   | íŒ€ë³„ê³¼ì œ ìˆ˜í–‰                       |
  | 09/23 PM  | Wrap Up        | ê³¼ì œ ì œì¶œ<br>ì‹œì‘:14ì‹œ<br>ë§ˆê°:16ì‹œ |

## ğŸ‘« Team

  | íŒ€  |   ì„±ëª…   | ì§ê¸‰ | ì†Œì†             |
  | :-: | :------: | :--: | :--------------- |
  |  2  | ğŸ– ìµœì›ì‹ | ê³¼ì¥ | ì„œë¹„ìŠ¤ìš´ì˜2íŒ€  |
  |     |  í™©ìƒì‹ | ê³¼ì¥ | ë””ì§€í„¸ì›Œí¬ê·¸ë£¹  |
  |     |  ê¹€ì˜ì¤€  | ëŒ€ë¦¬ | Platformê°œë°œíŒ€   |
  |     |  ì´ì¬ì˜ | ëŒ€ë¦¬ | ë””ì§€í„¸ì›Œí¬ê·¸ë£¹  |

## âœï¸ Evaluation

- ë¶„ì„ì„¤ê³„
- SAGA Pattern (Pub / Sub)                           : ê³µí†µ
- CQRS Pattern                                       : 
- Correlation / Compensation(Unique Key)             :
- Request / Response (Feign Client / Sync.Async)     : Order
- Gateway                                            : ê¹€ì˜ì¤€ ëŒ€ë¦¬
- Deploy / Pipeline                                  : ê³µí†µ
- Circuit Breaker                                    : Payment
- Autoscale(HPA)                                     : ê³µí†µ
- Self-Healing(Liveness Probe)                       : ê³µí†µ(deployment.yamlì— ì‘ì„±)
- Zero-Downtime Deploy(Readiness Probe)              : ê³µí†µ(deployment.yamlì— ì‘ì„±)
- Config Map / Persistence Volume                    : 
- Polyglot

## ğŸ“‘ To-Do

- <a href="https://www.msaez.io/#/" target="_blank">Brain Storming</a>

  - íŒ€ë³„ë¡œ ì£¼ì œ ì„ ì • ë° ì´ë²¤íŠ¸ ìŠ¤í† ë° ì§„í–‰

- GitHub : [https://github.com/seonguk9303/hw5_capstone_proj]
- GitPod
  - Github ê³„ì • ë° Repositoy(public) ì¤€ë¹„ ( **for FORK** )
  - gitpod.io/#/{Github-Repository-URL} or Browser Extension ì„¤ì¹˜(https://www.gitpod.io/docs/browser-extension)
  - Collaboration & Sharing
    - íŒ€ì¥ : github.com > repository > Settings > Collaborators > Add People ; íŒ€ì›ì´ˆëŒ€
    - íŒ€ì¥ / íŒ€ì› : gitpod.io > Settings > Integrations > GitHub > Edit Permissions > Public_repo Check ; GitPod - GitHub ê¶Œí•œì„¤ì •
  * gitpod ì´ˆê¸° ì—°ë™ì‹œ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì´ ì—†ëŠ” ìƒíƒœì´ë©° **.gitpod.yml** íŒŒì¼ì— ì„ ì–¸í•œ ëª…ë ¹ì–´ë“¤ ìë™ ì‹¤í–‰ë¨
  * ì‹¤í–‰ ì•ˆë˜ëŠ” ëª…ë ¹ì–´ë“¤ì´ ìˆìœ¼ë©´ ì§ì ‘ ì„¤ì¹˜
- AWS (_ì•½ 15~20ë¶„ ì†Œìš”_)
  - AWS IAM ê³„ì •(MSA5ì°¨ìˆ˜).xlsx ì°¸ê³ 
  - Region-Code : ë©”ì¼ ë‚´ Region
  - Cluster-Name : Account-Id
  - Image-Repository-Name : Account-Id

--------------------------------------------------
## ë¶„ì„ ì„¤ê³„ (ê³µí†µ)

### ë°°ë‹¬ì˜ë¯¼ì¡±

#### ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. ê³ ê°ì´ ë©”ë‰´ë¥¼ ì„ íƒí•˜ì—¬ ì£¼ë¬¸ í›„ ê²°ì œí•œë‹¤.
2. ì£¼ë¬¸ì´ ë˜ë©´ ì£¼ë¬¸ ë‚´ì—­ì´ ì…ì ìƒì ì£¼ì¸ì—ê²Œ ì „ë‹¬ëœë‹¤
3. ìƒì ì£¼ì¸ì´ í™•ì¸í•˜ì—¬ ìš”ë¦¬í•´ì„œ ë°°ë‹¬ ì¶œë°œí•œë‹¤
4. ê³ ê°ì´ ì£¼ë¬¸ì„ ì·¨ì†Œí•  ìˆ˜ ìˆë‹¤
5. ê³ ê°ì´ ì£¼ë¬¸ìƒíƒœë¥¼ ì¤‘ê°„ì¤‘ê°„ ì¡°íšŒí•œë‹¤

#### ë¹„ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. íŠ¸ëœì­ì…˜
ê²°ì œê°€ ë˜ì§€ ì•Šì€ ì£¼ë¬¸ê±´ì€ ì•„ì˜ˆ ê±°ë˜ê°€ ì„±ë¦½ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤ (Sync í˜¸ì¶œ)

2. ì¥ì• ê²©ë¦¬
ìƒì ê´€ë¦¬ ê¸°ëŠ¥ì´ ìˆ˜í–‰ë˜ì§€ ì•Šë”ë¼ë„ ì£¼ë¬¸ì€ 365ì¼ 24ì‹œê°„ ë°›ì„ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ Async (event-driven), Eventual Consistency
ê²°ì œì‹œìŠ¤í…œì´ ê³¼ì¤‘ë˜ë©´ ì‚¬ìš©ìë¥¼ ì ì‹œë™ì•ˆ ë°›ì§€ ì•Šê³  ê²°ì œë¥¼ ì ì‹œí›„ì— í•˜ë„ë¡ ìœ ë„í•œë‹¤ Circuit breaker, fallback

3. ì„±ëŠ¥
ê³ ê°ì´ ìì£¼ ìƒì ê´€ë¦¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ë°°ë‹¬ìƒíƒœë¥¼ ì£¼ë¬¸ì‹œìŠ¤í…œ(í”„ë¡ íŠ¸ì—”ë“œ)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ CQRS

--------------------------------------------------
## ì´ë²¤íŠ¸ìŠ¤í† ë° (ê³µí†µ)
- ì´ë²¤íŠ¸ìŠ¤í† ë° ê²°ê³¼
![image](https://user-images.githubusercontent.com/23250734/191643996-1c8d90db-0506-4f55-ad9e-e4a85bd4d625.png)

- ì£¼ë¬¸ -> ë°°ë‹¬ í”„ë¡œì„¸ìŠ¤
![image](https://user-images.githubusercontent.com/23250734/191655483-b91ea937-f779-4d52-8047-ec465fb21c03.png)

```
1. ê³ ê°ì´ ìŒì‹ì„ ì£¼ë¬¸í•¨ê³¼ ë™ì‹œì— ê²°ì œê°€ ì§„í–‰ëœë‹¤. (íŠ¸ëœì­ì…˜)
2. ìŒì‹ì ì—ì„œ ì£¼ë¬¸ ì •ë³´ë¥¼ í™•ì¸í•œë‹¤
3. ì¡°ë¦¬ë¥¼ ì‹œì‘í•˜ê³  ìŒì‹ ì¡°ë¦¬ê°€ ì™„ë£Œëœë‹¤.
4. ë°°ë‹¬ì›ì— ì˜í•´ ë°°ë‹¬ì´ ì‹œì‘ëœë‹¤.
5. ë°°ë‹¬ì›ì´ ìŒì‹ì„ í”½ì—…í•œë‹¤.
6. ë°°ë‹¬ì›ì´ ìŒì‹ ë°°ì†¡ì„ ì™„ë£Œí•œë‹¤.
7. ì£¼ë¬¸ ì „ì²´ ê³¼ì •ì„ ëŒ€ì‹œë³´ë“œë¥¼ í†µí•´ ì‚¬ìš©ìê°€ ì¡°íšŒí•œë‹¤.
```

- íŠ¸ëœì­ì…˜ 
![image](https://user-images.githubusercontent.com/23250734/191655924-98f7cff8-3a0c-4aab-b04f-2de851d1d7a7.png)
```
ì£¼ë¬¸ -> ê²°ì œ ê³¼ì •ì„ req/resë¡œ ì²˜ë¦¬í•˜ì—¬ íŠ¸ëœì­ì…˜ ì²˜ë¦¬í•˜ì˜€ë‹¤.
ê²°ì œê°€ ì´ë£¨ì–´ì§€ì§€ ì•Šìœ¼ë©´ ì£¼ë¬¸ì€ ì„±ë¦½ë˜ì§€ ì•ŠëŠ”ë‹¤.
```
- ì´ë²¤íŠ¸ ì²˜ë¦¬
```
ì£¼ë¬¸ -> ê²°ì œë¥¼ ì œì™¸í•œ ëª¨ë“  ì•¡ì…˜ì€ ì´ë²¤íŠ¸ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ì˜€ë‹¤.
ìƒì  ê´€ë¦¬ ê¸°ëŠ¥ì´ ìˆ˜í–‰ë˜ì§€ ì•Šë”ë¼ë„ ì£¼ë¬¸ì„ ë°›ì„ ìˆ˜ ìˆìœ¼ë©°, kafkaë¥¼ í†µí•´ ë¹„ë™ê¸° ì²˜ë¦¬ëœë‹¤.
```

--------------------------------------------------
## SAGA Pattern (Pub / Sub)
```
SAGA íŒ¨í„´ì€ MSA ê°œë°œ í™˜ê²½ì—ì„œ, ë¶„ì‚°ëœ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë“¤ ê°„ ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ì§€í‚¤ê¸° ìœ„í•œ ë°©ë²• ì¤‘ í•˜ë‚˜.
ì´ë²ˆ êµìœ¡ì—ì„  ì´ë²¤íŠ¸ pub/subë¥¼ í†µí•œ SAGA íŒ¨í„´ì— ëŒ€í•´ í•™ìŠµí•˜ì˜€ìŒ.
ì´ë²ˆ ë°°ë‹¬ì˜ë¯¼ì¡± ì‚¬ë¡€ì—ì„  ì‚¬ìš©ìê°€ ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ì˜€ì„ ë•Œ caseë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰.
```
- ì´ë²¤íŠ¸ìŠ¤í† ë° í”„ë¡œì„¸ìŠ¤
![image](https://user-images.githubusercontent.com/23250734/191657494-dc6fb681-1c6b-4e0c-8bd2-9f62e3f987e2.png)
```
ì‚¬ìš©ìê°€ ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ë©´, ê²°ì œ/ìƒì  ì£¼ë¬¸ì´ ë™ì‹œì— ì·¨ì†Œë˜ì–´ì•¼ í•œë‹¤.
ë”°ë¼ì„œ ì£¼ë¬¸ ì·¨ì†Œ ì´ë²¤íŠ¸ë¥¼ ê° ì„œë¹„ìŠ¤ì—ì„œ ìˆ˜ì‹ ë°›ì•„, ê° ì„œë¹„ìŠ¤ì˜ ì£¼ë¬¸ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤. (ë¹„ë™ê¸° ì¼ê´€ì„± ìœ ì§€)
```

#### ì´ë²¤íŠ¸ ë°œí–‰
Order.java
```
    //Order.javaì—ì„œ ì£¼ë¬¸ì´ ì·¨ì†Œë˜ì—ˆì„ ë•Œ (DELETE ìš”ì²­) OrderCanceledì´ë²¤íŠ¸ ë°œí–‰.
    @PostRemove
    public void onDeletePersist() {
        //orderì·¨ì†Œ ì‹œ orderCanceled ì´ë²¤íŠ¸ ë°œí–‰.
        OrderCanceled orderCanceled = new OrderCanceled(this);

        orderCanceled.setId(this.id);
        orderCanceled.setOrderStatus("CANCELED");

        orderCanceled.publishAfterCommit();
    }
```

#### ì´ë²¤íŠ¸ ìˆ˜ì‹ 
